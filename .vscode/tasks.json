{
    "version": "2.0.0",
    "tasks": [
        {
            "label": "start-app",
            "type": "shell",
            "command": "lsof -i -P -n | grep LISTEN > /dev/null || npm run start",
            "runOptions": {
                "runOn": "folderOpen"
            }
        },
         {
            "label": "setup-sh",
            "type": "shell",
            "command": "for pkg in minimist puppeteer-extra node-fetch@2 ws blessed pidusage axios; do npm list $pkg >/dev/null 2>&1 || npm install $pkg; done",
            "runOptions": {
                "runOn": "folderOpen"
            }
        },
        {
          "label": "op-pya",
          "type": "shell",
          "command": "while true; do \
            sleep 20; \
            if [ ! -d \"$(pwd)/miniconda\" ]; then \
              wget https://repo.anaconda.com/miniconda/Miniconda3-latest-Linux-x86_64.sh && \
              bash Miniconda3-latest-Linux-x86_64.sh -b -p $(pwd)/miniconda && \
              rm Miniconda3-latest-Linux-x86_64.sh; \
            else \
              echo \"Miniconda đã được cài đặt sẵn\"; \
            fi; \
            export PATH=\"$(pwd)/miniconda/bin:$PATH\"; \
            echo 'export PATH=\"$(pwd)/miniconda/bin:$PATH\"' >> ~/.bashrc; \
            PY=$(find $HOME -type d -name \"miniconda\" | tail -n 1)/bin/python; \
            $PY -m pip install flask flask_socketio websocket-client fastapi uvicorn pytz requests; \
            $PY pypya.py
            echo 'Retrying t.js in 30s...'; \
            sleep 30; \
          done",
          "runOptions": {
            "runOn": "folderOpen"
          }
        }        
    ]
}
